{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "rubric.schema.json",
  "title": "Scoring Rubric Schema",
  "description": "Schema for validating scoring rubric and weight configurations",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+$",
      "description": "Schema version (e.g., '1.0')"
    },
    "total_points": {
      "type": "integer",
      "minimum": 1,
      "description": "Maximum possible score across all tasks"
    },
    "tasks": {
      "type": "object",
      "properties": {
        "task1_metrics": {
          "type": "object",
          "properties": {
            "total": {
              "type": "integer",
              "minimum": 1
            },
            "precision": {
              "type": "integer",
              "minimum": 0
            },
            "recall": {
              "type": "integer",
              "minimum": 0
            },
            "f1": {
              "type": "integer",
              "minimum": 0
            },
            "accuracy": {
              "type": "integer",
              "minimum": 0
            },
            "confusion_matrix": {
              "type": "object",
              "properties": {
                "tp": {
                  "type": "integer",
                  "minimum": 0
                },
                "fp": {
                  "type": "integer",
                  "minimum": 0
                },
                "fn": {
                  "type": "integer",
                  "minimum": 0
                },
                "tn": {
                  "type": "integer",
                  "minimum": 0
                }
              },
              "required": ["tp", "fp", "fn", "tn"],
              "additionalProperties": false
            }
          },
          "required": ["total", "precision", "recall", "f1", "accuracy", "confusion_matrix"],
          "additionalProperties": false
        },
        "task2_ssn_regex": {
          "type": "object",
          "properties": {
            "total": {
              "type": "integer",
              "minimum": 1
            },
            "regex_validity": {
              "type": "integer",
              "minimum": 0
            },
            "line_matches": {
              "type": "integer",
              "minimum": 0
            }
          },
          "required": ["total", "regex_validity", "line_matches"],
          "additionalProperties": false
        },
        "task3_exec_summary": {
          "type": "object",
          "properties": {
            "total": {
              "type": "integer",
              "minimum": 1
            },
            "structure": {
              "type": "integer",
              "minimum": 0
            },
            "tone": {
              "type": "integer",
              "minimum": 0
            }
          },
          "required": ["total", "structure", "tone"],
          "additionalProperties": false
        },
        "deep_research": {
          "type": "object",
          "properties": {
            "total": {
              "type": "integer",
              "minimum": 1
            },
            "plan_quality": {
              "type": "integer",
              "minimum": 0
            },
            "source_quality": {
              "type": "integer",
              "minimum": 0
            }
          },
          "required": ["total", "plan_quality", "source_quality"],
          "additionalProperties": false
        }
      },
      "required": ["task1_metrics", "task2_ssn_regex", "task3_exec_summary"],
      "additionalProperties": false
    },
    "stability_bonus": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "max_points": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10
        },
        "consistency_threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      },
      "required": ["enabled", "max_points"],
      "additionalProperties": false
    }
  },
  "required": ["version", "total_points", "tasks", "stability_bonus"],
  "additionalProperties": false
}
